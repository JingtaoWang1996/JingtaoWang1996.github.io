---
title: 'NS3学习笔记'
date: 2025-12-31
permalink: /posts/2025/12/NS3学习笔记/
tags:
  - Real Work Practice
---

NS3网络模拟器（开发卫星互联网完整链路）学习笔记本



# NS3 Intro

## Source url

* 官网：https://www.nsnam.org/
  * 包含所有核心文档、下载、社区资源等
  * Tutorial:  登录官网后->doc->可以看到tutorial有个download
* Git：https://github.com/nsnam/ns-3-dev
* Wiki：https://www.nsnam.org/wiki/ [User and Developer FAQ、trouble Shooting Guide、paper]
* Source code： https://gitlab.com/nsnam/
* 

## Tutorial

* NS-3实质：a discrete-event simulator run from the command line 

  * 实际simulator撰写基于C++，场景配置可使用Python 

* **Written directly in C++**

* **simulation events are simply C++ function calls**

* ns-3 has optional Python bindings for authoring scenario configuration programs in Python 

* Most of the ns3 **API is available in python**，but the **models are written in C ++**

* 

*  

  

### Prerequisites 

* ns3 has various optional extensions，but the main features just require a **C++  compiler (g++ or clang ++)**、**Python 3.8+**、**CMAKE** and **a build-system** 

* Linux：g++、clang++
* Windows：Msys2 tools with MinGW64 toolchain can be used （ns-3.37）for most cases.【pyx之前搭的已经是3.42了】

## NS3 安装配置

* 47.236.28.227 : /leo/ns3/

### 核心依赖安装

* step1: 安装系统级核心依赖

```shell
sudo apt update
# 安装系统级核心依赖（编译器、系统库）
sudo apt install -y \
    g++ \
    gcc \
    cmake \
    libboost-all-dev \
    libgsl-dev \
    libgtk-3-dev \
    libxml2-dev \
    libsqlite3-dev \
    pkg-config \
    git \
    mercurial \
    valgrind \
    doxygen \
    graphviz \
    texlive-full
```

* step2：安装conda 

```shell
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
# 执行安装脚本：一路回车
bash Miniconda3-latest-Linux-x86_64.sh
# 使用以下命令让conda生效
source ~/.bashrc
```

* step3: conda创建NS3的环境【3.8-3.10】

```
conda create -n ns3 python=3.8 -y
```

* step4：安装依赖库

```
conda install -y pybind11
conda install -y numpy
conda install -y matplotlib
conda install -y ipython
```

* step5：cmake 版本更新

  ```
  # cmake 大于3.20 
  # 1. 下载cmake 3.28.0（最新稳定版，远高于3.20）
  wget https://github.com/Kitware/CMake/releases/download/v3.28.0/cmake-3.28.0-linux-x86_64.tar.gz
  # 2. 解压到/usr/local（系统默认路径，方便全局调用）
  sudo tar xzf cmake-3.28.0-linux-x86_64.tar.gz -C /usr/local --strip-components=1
  # 3. 刷新环境变量，让新cmake生效
  source ~/.bashrc
  # 4. 验证版本（输出≥3.20即可）
  cmake --version
  ```

* step6： GNU compiler版本要求

  ```shell
  # GNU至少大于11.0.0
  # 确认当前编译器版本
  gcc --version   # 输出 gcc (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
  g++ --version   # 同理，版本也是 9.4.0
  # 安装软件源管理工具
  sudo apt install -y software-properties-common
  # 添加 gcc 11 源（Ubuntu 20.04 需添加，22.04 自带）
  sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  sudo apt update
  # 安装gcc-11 和 g++ -11
  sudo apt install -y gcc-11 g++-11
  # 配置默认 gcc
  sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-11 100 --slave /usr/bin/g++ g++ /usr/bin/g++-11
  # 验证默认版本（输出 11.x 即可）
  gcc --version   # 正确输出：gcc (Ubuntu 11.4.0-1ubuntu1~20.04) 11.4.0
  g++ --version   # 同理，版本为 11.x
  ```


### 安装配置-按照tutorial的步骤进行

* 下载并解压到： /leo/ns3/

  ```shell
  cd /leo/ns3/
  wget https://www.nsnam.org/release/ns-3.45.tar.bz2
  tar xjf ns-3.45.tar.bz2
  cd ns-3.45
  ```

* Building with the ns3 CMake wrapper

  ```
  ./ns3 clean
  ./ns3 configure --build-profile=optimized --enable-examples --enable-tests
  ```

  PS: 若遇到root拒绝执行的问题，见下方《遇到的问题》

* 上面步骤执行完成后，the build system is now configured and you can build the debug version of the ns-3 programs by simply typing: 

  ```shell
  ./ns3 build 
  ```

* A command exists for checking which profile is currently active for an already configured project 

  ```shell
  ./ns3 show profile 
  ```

  期望输出：Build profile：debug 

* 测试命令：./ns3 run hello-simulator

  * 期望输出：hello-simulator

### 遇到的问题

* 3.45版本执行教程命令，脚本会拒绝root

  * 解决方式：

    * cd ns-3.45

    * 3.45脚本会拒绝root，跳过方式：

      ```python
      cd /leo/ns3/ns-3.45
      vim ./ns3
      # 找到下面部分的代码并对照修改
      def refuse_run_as_root():
          if os.geteuid() == 0:
              #raise Exception(
              #    "Refusing to run as root. --enable-sudo will request your password when needed")
              pass 
      ```




------

